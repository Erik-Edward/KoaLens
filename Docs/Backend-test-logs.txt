info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:40.513Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:40.513Z"}
info: AI Response [gemini] {"completionTokens":327.25,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:41.082Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.95,\"originalName\":\"Zure ROOMPOEDER 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:41.083Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:41.084Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"11.40","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:41.088Z"}
info: AI Response [gemini] {"completionTokens":327.5,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:42.364Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure Roompoeder 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.95}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:42.365Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:42.366Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"11.31","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:42.370Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:43.764Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:43.765Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:54:44.468Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:54:44.475Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:54:44.476Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:46.070Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:46.071Z"}
info: AI Response [gemini] {"completionTokens":330.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:48.788Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.95,\"originalName\":\"Zure roompoeder 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.95}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:48.803Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","be","ch","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:48.804Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"8.29","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:48.808Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:54:49.004Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:54:49.014Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:54:49.015Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:54:50.975Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:54:50.981Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:54:50.982Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:51.687Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:51.687Z"}
info: AI Response [gemini] {"completionTokens":327.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:53.390Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Uienpoeder 0,5 %\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure roompoeder 0,1 %\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Meelverbeteraar (Natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:53.402Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:53.402Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"9.64","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:53.406Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:54:55.362Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:54:55.367Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:54:55.367Z"}
info: AI Response [gemini] {"completionTokens":324.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:55.812Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure roompoeder 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:55.813Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:55.814Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"9.75","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:55.817Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:56.658Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:56.658Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:58.694Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:54:58.696Z"}
info: AI Response [gemini] {"completionTokens":324.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:54:59.462Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure Roompoeder 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:54:59.465Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:54:59.466Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"7.78","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:54:59.470Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:55:01.595Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:55:01.603Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:55:01.603Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:02.777Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:55:02.778Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:55:04.034Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:55:04.045Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:55:04.046Z"}
info: AI Response [gemini] {"completionTokens":324.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:55:05.859Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure roompoeder 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:55:05.861Z"}
info: Video analysis completed {"confidenceScore":0.8,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:55:05.861Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"9.21","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:05.866Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:55:07.204Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:55:07.216Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:55:07.218Z"}
info: AI Response [gemini] {"completionTokens":327.75,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:55:08.775Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Uienpoeder 0,5 %\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.95,\"originalName\":\"Zure ROOMPOEDER 0,1 %\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"Meelverbeteraar (Natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.9}]","service":"koalens-backend","timestamp":"2025-03-30T20:55:08.776Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:55:08.776Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"10.09","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:08.779Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:09.229Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:55:09.229Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:11.579Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:55:11.581Z"}
info: AI Response [gemini] {"completionTokens":326.25,"mediaTokens":"Video content","promptTokens":593.5,"provider":"gemini","responseText":"```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"TARWEBLOEM\",\n      \"isVegan\": true,\n      \"confide...","service":"koalens-backend","timestamp":"2025-03-30T20:55:11.759Z"}
info: Parsed ingredients data {"ingredientsData":"[{\"name\":\"vetemjöl\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"TARWEBLOEM\"},{\"name\":\"olja\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Palmolie\"},{\"name\":\"Glucosestroop\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"Rijsmiddelen (ammoniumcarbonaten, natriumcarbonaten)\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"salt\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Zout\"},{\"name\":\"socker\",\"isVegan\":true,\"confidence\":0.95,\"originalName\":\"Suiker\"},{\"name\":\"Dextrose\",\"isVegan\":true,\"confidence\":0.95},{\"name\":\"lök\",\"isVegan\":true,\"confidence\":0.9,\"originalName\":\"Uienpoeder 0,5%\"},{\"name\":\"Natuurlijk aroma\",\"isVegan\":true,\"confidence\":0.9},{\"name\":\"grädde\",\"isVegan\":false,\"confidence\":0.9,\"originalName\":\"Zure ROOMPOEDER 0,1%\"},{\"name\":\"Voedingszuren (citroenzuur, calciumlactaat)\",\"isVegan\":true,\"confidence\":0.8},{\"name\":\"Meelverbeteraar (natriumdisulfiet)\",\"isVegan\":true,\"confidence\":0.8}]","service":"koalens-backend","timestamp":"2025-03-30T20:55:11.762Z"}
info: Video analysis completed {"confidenceScore":0.9,"detectedLanguages":["nl","fr","de","it","es"],"ingredientCount":12,"isVegan":false,"operation":"response:success","processingTimeSec":0,"requestId":"not-provided","service":"videoAnalysis","statusCode":200,"timestamp":"2025-03-30T20:55:11.763Z"}
info: Video analysis completed {"ingredientCount":12,"isVegan":false,"processingTimeSec":"8.99","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:11.772Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:55:13.748Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:55:13.755Z","videoSizeKB":6494}
info: AI Request [gemini] {"generationConfig":{"maxOutputTokens":1536,"temperature":0.2,"topK":40,"topP":0.95},"mediaSizeBytes":6649368,"mediaType":"video/mp4","prompt":"\nDu är en expert på att analysera matprodukter och identifiera deras ingredienser.\n\nINSTRUKTIONER:\n1. Analysera videon NOGGRANT. Leta efter alla ingredienser som visas på förpackningen.\n2. Titta igenom hela videon. Om det finns en ingredienslista eller näringsinnehåll, fokusera på den.\n3. Identifiera ALLA ord i ingredienslistan. Var extra uppmärksam på korta ingredienser som \"salt\", \"olja\", \"vatten\", etc.\n4. Var speciellt noggrann med att identifiera alla animaliska ingredienser.\n5. VIKTIGT: Var mycket noggrann med veganska bedömningar. Markera endast ingredienser som \"isVegan\": false om de DEFINITIVT kommer från djur.\n   - Animaliska ingredienser inkluderar: ägg, mjölk, ost, grädde, kött, fisk, gelatin, honung, etc.\n   - Växtbaserade ingredienser som sojabaserade produkter (tofu, tempeh, sojasås, etc) är ALLTID veganska.\n6. Om det finns flera språk på förpackningen:\n   - Identifiera den svenska ingredienslistan om möjligt\n   - Undvik att lista samma ingrediens flera gånger på olika språk\n   - Ge alltid den svenska versionen om tillgänglig, annars originalet\n   - Varje ingrediens ska endast listas en gång (ingen duplicering)\n\nSVARA ENDAST MED ETT JSON-OBJEKT i detta format:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"ingrediensnamn\",\n      \"isVegan\": true/false,\n      \"confidence\": 0.0-1.0\n    },\n    ...\n  ],\n  \"isVegan\": true/false,\n  \"confidence\": 0.0-1.0,\n  \"detectedLanguages\": [\"sv\", \"en\", \"de\", ...] // Lista över språk du upptäckt på förpackningen\n}\n```\n\nEXEMPEL PÅ KORREKT SVAR:\n```json\n{\n  \"ingredients\": [\n    {\n      \"name\": \"Majskorn\",\n      \"isVegan\": true,\n      \"confidence\": 0.98\n    },\n    {\n      \"name\": \"Palmolja\",\n      \"isVegan\": true,\n      \"confidence\": 0.95\n    },\n    {\n      \"name\": \"Salt\",\n      \"isVegan\": true,\n      \"confidence\": 0.99\n    }\n  ],\n  \"isVegan\": true,\n  \"confidence\": 0.97,\n  \"detectedLanguages\": [\"sv\", \"en\"]\n}\n```\n\nSe till att:\n1. ALLTID följa det exakta JSON-formatet\n2. Ordningen på fälten ska vara: \"name\", \"isVegan\", \"confidence\" för varje ingrediens\n3. Identifiera ALLA ingredienser, även de kortaste som \"salt\"\n4. Ange \"confidence\" som ett nummer mellan 0 och 1\n5. Inkludera ALLA ingredienser du kan identifiera i videon\n6. Undvika duplicerade ingredienser även om de nämns på flera språk\n7. Korrekta klassifikationer av veganska/icke-veganska ingredienser, särskilt för sojabaserade produkter\n","provider":"gemini","service":"koalens-backend","timestamp":"2025-03-30T20:55:13.756Z"}
info: Video analysis request received {"dataSize":13866184,"mimeType":"video/quicktime","preferredLanguage":"sv","requestId":"not-provided","service":"koalens-backend","timestamp":"2025-03-30T20:55:15.120Z"}
info: Video analysis request received {"clientInfo":{},"dataSizeBytes":13866184,"mimeType":"video/quicktime","operation":"request","preferredLanguage":"sv","requestId":"not-provided","service":"videoAnalysis","timestamp":"2025-03-30T20:55:15.121Z"}
info: Video optimization completed {"compressionRatio":"1.56","optimizedSizeMB":"6.34","originalSizeMB":"9.92","service":"koalens-backend","timestamp":"2025-03-30T20:55:16.520Z"}
info: Sending video for AI analysis {"promptLength":2374,"service":"koalens-backend","timestamp":"2025-03-30T20:55:16.528Z","videoSizeKB":6494}