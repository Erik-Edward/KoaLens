 LOG  Initializing Supabase client for platform: android
 WARN  Require cycle: stores\useStore.ts -> stores\slices\createHistorySlice.ts -> stores\adapter.ts -> stores\useStore.ts

Require cycles are allowed, but can result in uninitialized values. Consider refactoring to remove the need for a cycle. [Component Stack]
 LOG  Använder riktig Firebase Analytics
 LOG  [Feedback Dummy] Initialized
 LOG  VisionCamera: Successfully loaded native module
 LOG  ImageCropPicker: Successfully loaded native module
 LOG  [Sentry] Limited functionality wrapper created for Expo Go
 WARN  App initialization timed out, proceeding anyway
 LOG  Initialiserar användardata...
 LOG  AuthProvider: Initial setup
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  Kontrollerar tidigare import...
 LOG  AuthProvider: Initial session check {"emailConfirmed": undefined, "hasAvatar": false, "hasSession": false}
 LOG  Legacy-produkter redan importerade: {"importDate": "2025-03-15T16:51:38.294Z", "importedProducts": 428}
 LOG  App initialization complete
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  App initialization complete
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Checking onboarding status: {"currentStep": 0, "hasAcceptedDisclaimer": true, "hasCompletedOnboarding": false}
 LOG  AuthProvider: Onboarding not completed, redirecting to onboarding
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: No session but onboarding not completed, staying in onboarding
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Startar registreringsprocess med email {"email": "erik.edvardsson.office+73@gmail.com"}
 LOG  AuthProvider: Förbereder användarmetadata {"avatarId": "gorilla", "avatarStyle": "supporter", "veganStatus": "supporter", "veganYears": 0}        
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Ingen giltig session, tvingar omdirigering till login
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  Login: Fyller i e-postadress från URL-parametrar: erik.edvardsson.office+73@gmail.com
 LOG  AuthProvider: Deep link detected: koalens://#access_token=eyJhbGciOiJIUzI1NiIsImtpZCI6IlFNMDhzcFM3Z1kwcmY2RnUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2xpeml1am9oZGtkbWFvZ2ZvZ2plLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJhYWQyZWY1ZC05OWVkLTRjYzEtOWM2OS01ZDE2ZDkyMTZkNzciLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzQyNDc4NzExLCJpYXQiOjE3NDI0NzUxMTEsImVtYWlsIjoiZXJpay5lZHZhcmRzc29uLm9mZmljZSs3M0BnbWFpbC5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIl19LCJ1c2VyX21ldGFkYXRhIjp7ImF2YXRhcl9pZCI6ImdvcmlsbGEiLCJhdmF0YXJfc3R5bGUiOiJzdXBwb3J0ZXIiLCJlbWFpbCI6ImVyaWsuZWR2YXJkc3Nvbi5vZmZpY2UrNzNAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwic3ViIjoiYWFkMmVmNWQtOTllZC00Y2MxLTljNjktNWQxNmQ5MjE2ZDc3IiwidmVnYW5fc3RhdHVzIjoic3VwcG9ydGVyIiwidmVnYW5feWVhcnMiOjB9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6Im90cCIsInRpbWVzdGFtcCI6MTc0MjQ3NTExMX1dLCJzZXNzaW9uX2lkIjoiYzFlMjVkMTUtZmE5Yy00OGQ5LThiNTItMzgzYjIzNTdjYzkyIiwiaXNfYW5vbnltb3VzIjpmYWxzZX0.uaBuZEXrR1VUaibdYD23YEiAAEy-khSBsKU5wBnXE3o&expires_at=1742478711&expires_in=3600&refresh_token=wxBFNjWdxKtUfmB6VTNv7Q&token_type=bearer&type=signup
 LOG  AuthProvider: Verification deep link detected with token
 LOG  AuthProvider: Found access token in URL
 LOG  AuthProvider: Successfully extracted email from token: erik.edvardsson.office+73@gmail.com
 LOG  AuthProvider: Attempting to refresh session with token
 LOG  AuthProvider: AppState "active" – startar polling för sessionuppdatering
 ERROR  AuthProvider: Error refreshing session: [AuthSessionMissingError: Auth session missing!]
 LOG  AuthProvider: Using extracted email despite refresh error
 LOG  Login: Fyller i e-postadress från URL-parametrar: erik.edvardsson.office+73@gmail.com
 LOG  AuthProvider: Polling session null
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": false, "userId": undefined}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Auth state change: SIGNED_IN {"hasSession": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: User signed in, updating session
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 WARN  [Layout children]: No route named "index" exists in nested children: ["dev", "(history)", "(profile)", "(scan)"] [Component Stack]
 WARN  [Layout children]: No route named "settings" exists in nested children: ["dev", "(history)", "(profile)", "(scan)"] [Component Stack]
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  UserProfileSync: Kontrollerar första inloggning för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  AuthProvider: User state uppdaterad, synkar med store
 LOG  AuthProvider: Uppdaterar store med användardata {"email": "erik.edvardsson.office+73@gmail.com", "hasMetadata": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Uppdaterar store med användardata {"email": "erik.edvardsson.office+73@gmail.com", "hasMetadata": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  UserProfileSync: Första inloggning detekterad för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  AuthProvider: Sparade Supabase användar-ID aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 i AsyncStorage
 LOG  AuthSlice: Uppdaterar user-objekt vid inloggning {"email": "erik.edvardsson.office+73@gmail.com", "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Store uppdaterad med användardata
 LOG  AuthProvider: Sparade Supabase användar-ID aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 i AsyncStorage
 LOG  AuthSlice: Uppdaterar user-objekt vid inloggning {"email": "erik.edvardsson.office+73@gmail.com", "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Store uppdaterad med användardata
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 WARN  [Layout children]: No route named "index" exists in nested children: ["dev", "(history)", "(profile)", "(scan)"] [Component Stack]
 WARN  [Layout children]: No route named "settings" exists in nested children: ["dev", "(history)", "(profile)", "(scan)"] [Component Stack]
 LOG  HistoryScreen: Inloggad användare: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77, källa: auth
 LOG  useProducts: Laddar produkter...
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: Börjar synkronisera produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Utför tvåvägssynkronisering med Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Hämtar produkter från Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  HistoryScreen: 0 produkter laddade
 LOG  HistoryScreen: Inga produkter att visa
 LOG  AuthSlice: Användar-ID initialiserades
 LOG  AuthSlice: Användar-ID initialiserades
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 ERROR  Fel vid kontroll om tabell existerar: {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"}
 LOG  Kan inte hämta produkter - tabellen 'products' existerar inte
 LOG  Inga produkter hittades i Supabase
 LOG  Inga produkter hämtades från Supabase, eller operationen misslyckades
 LOG  Synkroniserar alla produkter till Supabase...
 LOG  Produkter framgångsrikt synkroniserade till Supabase
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  useProducts: Synkronisering slutförd
 LOG  Hämtar produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Ingen användarspecifik cache hittades för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Hämtar produkter för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från huvudlagring...
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  Hittade totalt 22 produkter i huvudlagring
 LOG  Unika användar-ID i produktlagring: [b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, e48037e5-7cfc-4654-96e4-80f077d7767f, 33feeaed-7d0c-4fe4-8cdf-13479f43998e, ab05c24d-214e-404f-891d-cf8b5382aee8, eecd896d-e221-4bcd-ab5b-6092690d1583, 55a078c6-8903-44e0-92da-474c325daa40, 13a8d21a-94a9-46c3-92fa-a0f618bd96f6, c91b86c8-be28-4ec0-bfc9-2c04507289db, fa3abd23-d028-42dc-8ae2-393814dfcccf]
 LOG  Hittade 0 produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från alla produkter
 LOG  Inga produkter hittades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  22 sparade produkter har annat användar-ID än aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Uppdaterar användarspecifik cache för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 med 0 produkter
 LOG  useProducts: 0 produkter hämtades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: 0 av 0 produkter är markerade som sparade i historiken
 LOG  HistoryScreen: 0 produkter laddade
 LOG  HistoryScreen: Inga produkter att visa
 LOG  AuthProvider: Polling session {"access_token": "eyJhbGciOiJIUzI1NiIsImtpZCI6IlFNMDhzcFM3Z1kwcmY2RnUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2xpeml1am9oZGtkbWFvZ2ZvZ2plLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJhYWQyZWY1ZC05OWVkLTRjYzEtOWM2OS01ZDE2ZDkyMTZkNzciLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzQyNDc4NzE4LCJpYXQiOjE3NDI0NzUxMTgsImVtYWlsIjoiZXJpay5lZHZhcmRzc29uLm9mZmljZSs3M0BnbWFpbC5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIl19LCJ1c2VyX21ldGFkYXRhIjp7ImF2YXRhcl9pZCI6ImdvcmlsbGEiLCJhdmF0YXJfc3R5bGUiOiJzdXBwb3J0ZXIiLCJlbWFpbCI6ImVyaWsuZWR2YXJkc3Nvbi5vZmZpY2UrNzNAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwic3ViIjoiYWFkMmVmNWQtOTllZC00Y2MxLTljNjktNWQxNmQ5MjE2ZDc3IiwidmVnYW5fc3RhdHVzIjoic3VwcG9ydGVyIiwidmVnYW5feWVhcnMiOjB9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6InBhc3N3b3JkIiwidGltZXN0YW1wIjoxNzQyNDc1MTE4fV0sInNlc3Npb25faWQiOiI3ZmZmNzFmYy01NjAxLTQzYWUtOWFlMy0yMDY1OGJjYWU4NGUiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.aRdtTxl3c4ms6Ak01_uSdhdt503cm1rcu4GBu--J6Cg", "expires_at": 1742478718, "expires_in": 3600, "refresh_token": "lcQBbHtUGQGMuORaD-8TbQ", "token_type": "bearer", "user": {"app_metadata": {"provider": "email", "providers": [Array]}, "aud": "authenticated", "confirmation_sent_at": "2025-03-20T12:50:37.755737Z", "confirmed_at": "2025-03-20T12:51:51.545801Z", "created_at": "2025-03-20T12:50:37.709891Z", "email": "erik.edvardsson.office+73@gmail.com", "email_confirmed_at": "2025-03-20T12:51:51.545801Z", "id": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77", "identities": [[Object]], "is_anonymous": false, "last_sign_in_at": "2025-03-20T12:51:58.934038232Z", "phone": "", "role": "authenticated", "updated_at": "2025-03-20T12:51:58.937108Z", "user_metadata": {"avatar_id": "gorilla", "avatar_style": "supporter", "email": "erik.edvardsson.office+73@gmail.com", "email_verified": true, "phone_verified": false, "sub": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77", "vegan_status": "supporter", "vegan_years": 0}}}
 LOG  AuthProvider: Session uppdaterad med verifierad e-post
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: User state uppdaterad, synkar med store
 LOG  AuthProvider: Uppdaterar store med användardata {"email": "erik.edvardsson.office+73@gmail.com", "hasMetadata": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Synkroniserar avatar från polling: {"id": "gorilla", "style": "supporter"}
 LOG  AuthProvider: Sparade Supabase användar-ID aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 i AsyncStorage
 LOG  AuthSlice: Uppdaterar user-objekt vid inloggning {"email": "erik.edvardsson.office+73@gmail.com", "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Store uppdaterad med användardata
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  HistoryScreen: Inloggad användare: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77, källa: auth
 LOG  useProducts: Laddar produkter...
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: Börjar synkronisera produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Utför tvåvägssynkronisering med Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Hämtar produkter från Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  HistoryScreen: 0 produkter laddade
 LOG  HistoryScreen: Inga produkter att visa
 LOG  AuthSlice: Användar-ID initialiserades
 LOG  UsageLimitIndicator mounted/updated, current values: {"analysesLimit": 2, "analysesUsed": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  ScanScreen component mounted, pathname: /camera
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /camera
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Analytics: Logging screen view ScanScreen
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead. [Component Stack]
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Navigation state changed, pathname: /camera isCameraOrSubRoute: true
 LOG  Scan tab focused, ensuring clean state
 LOG  Global app state reset completed
 LOG  Starting debounced reset
 ERROR  Fel vid kontroll om tabell existerar: {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"}
 LOG  Kan inte hämta produkter - tabellen 'products' existerar inte
 LOG  Inga produkter hittades i Supabase
 LOG  Inga produkter hämtades från Supabase, eller operationen misslyckades
 LOG  Synkroniserar alla produkter till Supabase...
 LOG  Produkter framgångsrikt synkroniserade till Supabase
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  useProducts: Synkronisering slutförd
 LOG  Hämtar produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Användarspecifik cache fanns men var tom för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Hämtar produkter för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från huvudlagring...
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  Hittade totalt 22 produkter i huvudlagring
 LOG  Unika användar-ID i produktlagring: [b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, e48037e5-7cfc-4654-96e4-80f077d7767f, 33feeaed-7d0c-4fe4-8cdf-13479f43998e, ab05c24d-214e-404f-891d-cf8b5382aee8, eecd896d-e221-4bcd-ab5b-6092690d1583, 55a078c6-8903-44e0-92da-474c325daa40, 13a8d21a-94a9-46c3-92fa-a0f618bd96f6, c91b86c8-be28-4ec0-bfc9-2c04507289db, fa3abd23-d028-42dc-8ae2-393814dfcccf]
 LOG  Hittade 0 produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från alla produkter
 LOG  Inga produkter hittades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  22 sparade produkter har annat användar-ID än aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Uppdaterar användarspecifik cache för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 med 0 produkter
 LOG  useProducts: 0 produkter hämtades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: 0 av 0 produkter är markerade som sparade i historiken
 LOG  HistoryScreen: 0 produkter laddade
 LOG  HistoryScreen: Inga produkter att visa
 LOG  Performing debounced reset now
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /camera
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Global app state reset completed
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  ScanScreen component unmounting
 LOG  ScanScreen component mounted, pathname: /
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Global app state reset completed
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:05.903Z", "limit": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:05.903Z", "limit": 2, "total": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:07.183Z", "limit": 2, "total": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Navigating to camera with permissions already granted
 LOG  Setting up camera screen navigation lock
 LOG  Setting up navigation protection
 LOG  Analytics: Logging screen view Camera
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead. [Component Stack]
 LOG  Camera screen mounted
 LOG  Navigation state changed, pathname: / isCameraOrSubRoute: false
 LOG  ScanScreen component unmounting
 LOG  ScanScreen component mounted, pathname: /camera
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /camera
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:07.604Z", "limit": 2, "total": 0}
 LOG  Global app state reset completed
 LOG  Camera navigation locked successfully
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:08.049Z", "limit": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:08.269Z", "limit": 2, "total": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:10.073Z", "limit": 2, "total": 0}
 LOG  Analytics: Logging event scan_started {"app_version": 31, "platform": "android"}
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead.  
 LOG  Navigation unlocked for photo navigation
 LOG  Setting up navigation protection
 LOG  Navigating to crop screen with photo path: /data/user/0/com.erikedward.KoaLens/cache/mrousavy8595837439973266207.jpg
 LOG  Camera screen unmounting, cleaning up
 LOG  Navigation state changed, pathname: /camera isCameraOrSubRoute: true
 LOG  Navigation till crop-skärmen initierad
 LOG  ScanScreen component unmounting
 LOG  ScanScreen component mounted, pathname: /crop
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /crop
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Camera navigation lock cleared
 LOG  Global app state reset completed
 LOG  Analytics: Logging event image_analysis_started {"app_version": 31, "imageHeight": 2000, "imageWidth": 2000, "isLandscape": false, "platform": "android"}
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead.  
 LOG  Läser bildfil: file:///storage/emulated/0/Android/data/com.erikedward.KoaLens/files/Pictures/d4b52b03-c5eb-41bc-85d9-629da8ee3d8c.jpg
 LOG  Läser fil som base64...
 LOG  AuthProvider: AppState "active" – startar polling för sessionuppdatering
 LOG  Kontrollerar om fallback-navigering behövs
 LOG  Navigation state changed, pathname: /crop isCameraOrSubRoute: true
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Base64-kodning slutförd, längd: 2083976
 LOG  Användar-ID för API-anrop: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Skickar bild till Claude Vision-analys... {"endpoint": "https://koalens-backend.fly.dev/analyze", "imageSize": "1526KB", "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:27.315Z", "limit": 2, "total": 0}
 LOG  AuthProvider: Polling session {"access_token": "eyJhbGciOiJIUzI1NiIsImtpZCI6IlFNMDhzcFM3Z1kwcmY2RnUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2xpeml1am9oZGtkbWFvZ2ZvZ2plLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJhYWQyZWY1ZC05OWVkLTRjYzEtOWM2OS01ZDE2ZDkyMTZkNzciLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzQyNDc4NzE4LCJpYXQiOjE3NDI0NzUxMTgsImVtYWlsIjoiZXJpay5lZHZhcmRzc29uLm9mZmljZSs3M0BnbWFpbC5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIl19LCJ1c2VyX21ldGFkYXRhIjp7ImF2YXRhcl9pZCI6ImdvcmlsbGEiLCJhdmF0YXJfc3R5bGUiOiJzdXBwb3J0ZXIiLCJlbWFpbCI6ImVyaWsuZWR2YXJkc3Nvbi5vZmZpY2UrNzNAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwic3ViIjoiYWFkMmVmNWQtOTllZC00Y2MxLTljNjktNWQxNmQ5MjE2ZDc3IiwidmVnYW5fc3RhdHVzIjoic3VwcG9ydGVyIiwidmVnYW5feWVhcnMiOjB9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6InBhc3N3b3JkIiwidGltZXN0YW1wIjoxNzQyNDc1MTE4fV0sInNlc3Npb25faWQiOiI3ZmZmNzFmYy01NjAxLTQzYWUtOWFlMy0yMDY1OGJjYWU4NGUiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.aRdtTxl3c4ms6Ak01_uSdhdt503cm1rcu4GBu--J6Cg", "expires_at": 1742478718, "expires_in": 3600, "refresh_token": "lcQBbHtUGQGMuORaD-8TbQ", "token_type": "bearer", "user": {"app_metadata": {"provider": "email", "providers": [Array]}, "aud": "authenticated", "confirmation_sent_at": "2025-03-20T12:50:37.755737Z", "confirmed_at": "2025-03-20T12:51:51.545801Z", "created_at": "2025-03-20T12:50:37.709891Z", "email": "erik.edvardsson.office+73@gmail.com", "email_confirmed_at": "2025-03-20T12:51:51.545801Z", "id": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77", "identities": [[Object]], "is_anonymous": false, "last_sign_in_at": "2025-03-20T12:51:58.934038232Z", "phone": "", "role": "authenticated", "updated_at": "2025-03-20T12:51:58.937108Z", "user_metadata": {"avatar_id": "gorilla", "avatar_style": "supporter", "email": "erik.edvardsson.office+73@gmail.com", "email_verified": true, "phone_verified": false, "sub": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77", "vegan_status": "supporter", "vegan_years": 0}}}
 LOG  AuthProvider: Session uppdaterad med verifierad e-post
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  ScanScreen component unmounting
 LOG  AuthProvider: Städar upp - avregistrerar prenumeration
 LOG  ScanScreen component mounted, pathname: /
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Analytics: Logging screen view ScanScreen
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead. [Component Stack]
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  UsageLimitIndicator mounted/updated, current values: {"analysesLimit": 2, "analysesUsed": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  ScanScreen component mounted, pathname: /
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Analytics: Logging screen view ScanScreen
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead. [Component Stack]
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Scan tab focused, ensuring clean state
 LOG  Navigation state changed, pathname: / isCameraOrSubRoute: false
 LOG  Navigation state changed, pathname: / isCameraOrSubRoute: false
 LOG  AuthProvider: User state uppdaterad, synkar med store
 LOG  AuthProvider: Uppdaterar store med användardata {"email": "erik.edvardsson.office+73@gmail.com", "hasMetadata": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Konfigurerar auth-ändringshanterare
 LOG  AuthProvider: Synkroniserar avatar från polling: {"id": "gorilla", "style": "supporter"}
 LOG  Global app state reset completed
 LOG  Global app state reset completed
 LOG  Starting debounced reset
 LOG  AuthProvider: Sparade Supabase användar-ID aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 i AsyncStorage
 LOG  AuthSlice: Uppdaterar user-objekt vid inloggning {"email": "erik.edvardsson.office+73@gmail.com", "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  HistoryScreen: Inloggad användare: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  AuthProvider: Store uppdaterad med användardata
 LOG  AuthProvider: Auth state change: INITIAL_SESSION {"hasSession": true, "userId": "aad2ef5d-99ed-4cc1-9c69-5d16d9216d77"}
 LOG  AuthProvider: Hanterar ej auth event INITIAL_SESSION
 LOG  AuthSlice: Användar-ID initialiserades
 LOG  Performing debounced reset now
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Global app state reset completed
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  API-svar mottaget, status: 200
 LOG  API-svarsdata: {"allIngredientsCount": 3, "error": "none", "hasAllIngredients": true, "hasIngredients": false, "ingredientsCount": 0, "isVegan": true, "success": undefined}
 LOG  Ingredienser extraherade framgångsrikt från allIngredients: 3
 LOG  Analytics: Logging event image_analysis_completed {"app_version": 31, "ingredientsCount": 3, "platform": "android"}
 WARN  This method is deprecated (as well as all React Native Firebase namespaced API) and will be removed in the next major release as part of move to match Firebase Web modular SDK API. Please see migration guide for more details: https://rnfirebase.io/migrating-to-v22 Please use `getApp()` instead.  
 LOG  Navigating to result screen with extracted ingredients: 3
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:32.726Z", "limit": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:32.726Z", "limit": 2, "total": 0}
 LOG  Försöker navigera till resultatskärmen med params: {"ingredients": "3 st", "pathname": "/(tabs)/(scan)/result", "photoPath": "file:///storage/emulated/0/Android/data/com.erikedward.KoaLens/files/Pictures/d4b52b03-c5eb-41bc-85d9-629da8ee3d8c.jpg"}
 LOG  ScanScreen component unmounting
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77, källa: auth
 LOG  useProducts: Laddar produkter...
 LOG  useProducts: Använder användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: Börjar synkronisera produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Utför tvåvägssynkronisering med Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Hämtar produkter från Supabase för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Analyserar 3 ingredienser
 LOG  ScanResultScreen: Använder användar-ID från auth: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Använder giltigt användar-ID för analys: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Navigation state changed, pathname: / isCameraOrSubRoute: false
 LOG  Navigation till resultatskärmen slutförd
 LOG  ScanScreen component unmounting
 LOG  ScanScreen component mounted, pathname: /result
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /result
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:32.726Z", "limit": 2, "total": 0}
 LOG  Global app state reset completed
 ERROR  Fel vid kontroll om tabell existerar: {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"}
 LOG  Kan inte hämta produkter - tabellen 'products' existerar inte
 LOG  Inga produkter hittades i Supabase
 LOG  Inga produkter hämtades från Supabase, eller operationen misslyckades
 LOG  Synkroniserar alla produkter till Supabase...
 LOG  Produkter framgångsrikt synkroniserade till Supabase
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  useProducts: Synkronisering slutförd
 LOG  Hämtar produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77...
 LOG  Användarspecifik cache fanns men var tom för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Hämtar produkter för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från huvudlagring...
 LOG  Hämtar alla produkter från AsyncStorage via koalens_products
 LOG  Hittade 22 produkter i AsyncStorage
 LOG  Produkt 1/22: ID=9d87ac4b-a2e8-42e9-8fbe-cefa58e08efb, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 2/22: ID=0dd9dcc5-f596-433a-af14-dd97b4edc6af, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 3/22: ID=daa77185-9578-4e99-9c26-9fe4f86ed364, UserId=b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, Sparad=Ja
 LOG  Produkt 4/22: ID=2dd36f4d-ce4e-45ae-8ba9-0378f4d97d8c, UserId=e48037e5-7cfc-4654-96e4-80f077d7767f, Sparad=Ja
 LOG  Produkt 5/22: ID=86b8e62b-4b63-43ec-bf8a-01b14bb4f3ed, UserId=33feeaed-7d0c-4fe4-8cdf-13479f43998e, Sparad=Ja
 LOG  Hittade totalt 22 produkter i huvudlagring
 LOG  Unika användar-ID i produktlagring: [b7a66499-fdfe-4a9f-b1c1-38fa91b6817f, e48037e5-7cfc-4654-96e4-80f077d7767f, 33feeaed-7d0c-4fe4-8cdf-13479f43998e, ab05c24d-214e-404f-891d-cf8b5382aee8, eecd896d-e221-4bcd-ab5b-6092690d1583, 55a078c6-8903-44e0-92da-474c325daa40, 13a8d21a-94a9-46c3-92fa-a0f618bd96f6, c91b86c8-be28-4ec0-bfc9-2c04507289db, fa3abd23-d028-42dc-8ae2-393814dfcccf]
 LOG  Hittade 0 produkter för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 från alla produkter
 LOG  Inga produkter hittades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  22 sparade produkter har annat användar-ID än aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Uppdaterar användarspecifik cache för aad2ef5d-99ed-4cc1-9c69-5d16d9216d77 med 0 produkter
 LOG  useProducts: 0 produkter hämtades för användare aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  useProducts: 0 av 0 produkter är markerade som sparade i historiken
 ERROR  Fel vid hämtning från Supabase (användardata): {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"} 
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 ERROR  Fel vid hämtning från Supabase (användardata): {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"} 
 LOG  Registrerar analys i användarstatistik...
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 ERROR  Fel vid hämtning från Supabase (användardata): {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"} 
 LOG  Analys registrerad i användarstatistik, resultat: true
 LOG  Väntar på att backend ska uppdatera användaranalytik...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Attempt 1/3 to fetch usage data...
 ERROR  Fel vid kontroll av befintlig post: {"code": "42501", "details": null, "hint": null, "message": "permission denied for table users"}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:34.108Z", "limit": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:34.108Z", "limit": 2, "total": 0}
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:34.536Z", "limit": 2, "total": 0}
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:35.298Z", "limit": 2, "total": 0}
 LOG  Tvingar fram uppdatering av användningsgränser från servern...
 LOG  Forcerar omedelbar uppdatering från servern för användar-ID: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Färsk data hämtad direkt från servern: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Uppdaterar store med färsk data: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Uppdatering av användningsgränser: lyckades
 LOG  Genererar nytt produkt-ID: 5b0345ca-54f3-4d0f-97a8-d8e33ec6dd89
 LOG  Produkt skapad med ID: 5b0345ca-54f3-4d0f-97a8-d8e33ec6dd89
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:37.250Z", "limit": 2, "total": 0}
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:37.317Z", "limit": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:37.317Z", "limit": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:52:37.317Z", "limit": 2, "total": 0}
 LOG  Scan tab focused, ensuring clean state
 LOG  Navigation state changed, pathname: /result isCameraOrSubRoute: true
 LOG  ScanScreen component unmounting
 LOG  ScanScreen component mounted, pathname: /
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Detected coming from result screen, giving extra time
 LOG  Global app state reset completed
 LOG  Starting debounced reset
 LOG  Performing debounced reset now
 LOG  Performing a global app state reset
 LOG  Resetting scan screen state, current pathname: /result
 LOG  Forcerar uppdatering av användningsgränser med fördröjning...
 LOG  Global app state reset completed
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Refreshing usage limit for user: aad2ef5d-99ed-4cc1-9c69-5d16d9216d77
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:53:03.276Z", "limit": 2, "total": 0}
 LOG  Attempt 1/3 to fetch usage data...
 LOG  Usage data received: {"analysesLimit": 2, "analysesUsed": 0, "isPremium": false, "remaining": 2}
 LOG  Mapped usage values: {"isPremium": false, "limit": 2, "total": 0}
 LOG  Usage limit refreshed successfully
 LOG  New usage values: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Användargränser uppdaterade framgångsrikt efter delay
 LOG  Aktuell användargräns: {"limit": 2, "remaining": 2, "total": 0}
 LOG  Verifierar användningsgräns efter uppdatering: {"lastChecked": "2025-03-20T12:53:03.686Z", "limit": 2, "total": 0}